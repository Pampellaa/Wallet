{% extends 'dash.html' %}

{% block content %}
    <div class="container mt-4">
        <h2>Twoje cele oszczędnościowe:</h2>
        <ul class="list-group">
            {% for saving in savings %}
                <li class="list-group-item">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h4>{{ saving.name }}</h4>
                            <p>Cel: {{ saving.goal_amount }} zł</p>
                            <p>Obecnie: {{ saving.current_amount }} zł</p>
                            <p>Miesięczna wpłata aby osiągnąć cel: {{ saving.monthly_deposit|floatformat:2 }} zł</p>
                            <p>Ostatnia wpłata: {{ saving.last_deposit_date }}</p>
                            <p>Pozostało: {{ saving.remaining_amount }} zł</p>
                            {% if saving.remaining_amount == 0 %}
                                <p class="text-success">Gratulacje! Osiągnąłeś swój cel oszczędnościowy!</p>
                                <form method="post" action="{% url 'savings_delete' saving.id %}">
                                    {% csrf_token %}
                                    <button class="btn btn-danger ml-2" type="submit"><i class="fas fa-trash"></i> Usuń cel</button>
                                </form>
                            {% endif %}
                        </div>
                            <form class="d-flex" method="post" action="{% url 'add_money_to_savings' saving.id %}">
                            {% csrf_token %}
                            <div class="input-group">
                                <input class="form-control" type="number" name="amount" step="0.01" placeholder="Wprowadź kwotę">
                                <div class="input-group-append">
                                    <button class="btn btn-primary" type="submit"><i class="fas fa-plus"></i> Dodaj</button>
                                </div>
                            </div>
                            {% if invalid_saving_id == saving.id %}
                                {{ error_message }}
                            {% endif %}
                        </form>
                    </div>
                </li>
            {% endfor %}
        </ul>
        <a href="{% url 'savings_add' %}" class="btn btn-success mt-3"><i class="fas fa-plus"></i> Dodaj cel oszczędnościowy</a>
    </div>
{% endblock %}